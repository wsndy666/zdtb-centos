# 激活码功能使用说明

## 概述

本系统已集成激活码验证功能，用于控制软件的使用期限。激活码采用加密算法生成，具有防破解、高效验证的特点。

## 功能特点

### 🔐 安全性
- 使用HMAC-SHA256加密算法
- Base64编码确保传输安全
- 防篡改签名验证
- 时间戳防重放攻击

### ⚡ 高效性
- 本地验证，无需联网
- 快速响应，毫秒级验证
- 轻量级设计，占用资源少

### 🛠️ 便捷性
- 图形化管理界面
- 一键生成激活码
- 自动格式化输入
- 详细状态显示

## 使用方法

### 1. 生成激活码

#### 方法一：使用图形界面（推荐）
1. 双击运行 `启动激活码管理工具.bat`
2. 在"用户信息"框中输入用户名称
3. 设置"有效天数"（默认365天）
4. 选择是否"绑定机器"（绑定后只能在当前机器使用）
5. 点击"生成激活码"按钮
6. 复制生成的激活码

#### 方法二：使用命令行
```bash
# 激活虚拟环境
.venv\Scripts\Activate.ps1

# 生成激活码（30天有效期）
python activation_generator.py --generate --user "用户名" --days 30

# 生成绑定机器的激活码
python activation_generator.py --generate --user "用户名" --days 365 --machine
```

### 2. 激活软件

1. 启动自动填报系统
2. 访问"关于"页面
3. 在激活码输入框中输入激活码
4. 点击"激活"按钮
5. 系统会自动验证并显示激活状态

### 3. 验证激活码

#### 使用图形界面
1. 在激活码管理工具中
2. 在"验证激活码"区域输入激活码
3. 点击"验证"查看是否有效
4. 点击"查看信息"获取详细信息

#### 使用命令行
```bash
# 验证激活码
python activation_generator.py --verify "激活码"

# 查看激活码信息
python activation_generator.py --info "激活码"
```

## 激活码格式

激活码采用分段格式，便于输入和识别：
```
eyJ2-ZXJz-aW9u-Ijoi-MS4w-Iiwi-aXNz-dWVf-ZGF0-ZSI6-IjIw...
```

- 每4个字符用连字符分隔
- 自动转换为大写字母
- 支持复制粘贴

## 状态说明

### 激活状态
- ✅ **已激活**：显示用户信息、到期时间、剩余天数
- ❌ **未激活**：显示激活码输入界面

### 验证结果
- ✅ **激活成功**：激活码有效，系统已激活
- ❌ **激活码无效**：格式错误或签名验证失败
- ❌ **激活码已过期**：超过有效期限
- ❌ **机器不匹配**：激活码绑定了其他机器

## 常见问题

### Q1: 激活码输入后提示无效？
**A:** 请检查：
- 激活码是否完整（包含所有字符）
- 是否在有效期内
- 如果是机器绑定的激活码，是否在正确的机器上使用

### Q2: 如何查看激活码的详细信息？
**A:** 可以通过以下方式：
- 使用激活码管理工具的"查看信息"功能
- 命令行：`python activation_generator.py --info "激活码"`

### Q3: 激活码可以在多台机器上使用吗？
**A:** 取决于生成时的设置：
- 未绑定机器：可以在任意机器上使用
- 绑定机器：只能在生成激活码的机器上使用

### Q4: 激活码过期后怎么办？
**A:** 需要重新生成新的激活码进行激活

### Q5: 如何批量生成激活码？
**A:** 可以编写脚本调用 `ActivationCodeGenerator` 类进行批量生成

## 技术细节

### 加密算法
- **签名算法**：HMAC-SHA256
- **编码方式**：Base64
- **密钥管理**：内置密钥，可自定义

### 数据结构
激活码包含以下信息：
```json
{
  "version": "1.0",
  "issue_date": "2025-07-27T18:05:51.602881",
  "expire_date": "2025-08-26T18:05:51.602881",
  "days_valid": 30,
  "user_info": "用户名",
  "machine_binding": false,
  "random_salt": "随机盐值"
}
```

### 安全特性
1. **防篡改**：HMAC签名确保数据完整性
2. **防重放**：时间戳验证防止过期激活码重用
3. **机器绑定**：可选的硬件指纹绑定
4. **随机盐值**：增加破解难度

## 注意事项

1. **妥善保管激活码**：激活码具有时效性，请及时使用
2. **备份重要数据**：激活状态存储在本地数据库中
3. **定期更新**：建议定期更新激活码以确保安全性
4. **网络安全**：虽然是本地验证，但仍需注意网络安全

## 联系支持

如果在使用过程中遇到问题，请联系技术支持：
- 邮箱：support@example.com
- 电话：400-xxx-xxxx

---

*本文档最后更新时间：2025年7月27日*